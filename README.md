# goMetricService
Сервис для сбора данных с мобильного приложения BookCourt

# Инструкция
1. Для запуска необходимо произвести экспорт переменных среды, которые содержатся в .env файле. Это можно
   сделать самостоятельно, либо при использовании утилиты direnv. 

# Архитектура

![image](https://github.com/wanna-beat-by-bit/goMetricService/assets/71206074/9b1fb18e-b221-49d6-adde-1d3d2fb0e300)

Данный севрис не является каким-то большим, соотвественно, реализовывать надо не так много
### Эндпойнт
Отвечает за принятие данных, а также их маппинг на бизнес сущности в виде заготовленных структур метрик. 
Также может иметься некоторая валидация данных, чтобы исключить принятие невалдиных данных для хранения.

### Сервис
Данный элемент между самой базой данных нужен, если будет необходимость дополнительной обаботки метрик, 
а также в данный элемент будет работать со базой данных при помощи Storage, который является clickhouse

### База данных
База данных будет хранится в отдельрном докер контейнере. Стурктура clickhouse, реализующая интерфейс 
storage будет иметь все необохдимые функции для взаимодействия с clickhouse.

# Управление проектом
* Запуск проекта
```
make build
make run
```
* Запустить в докере
```
make dc
```
* Создать миграции
```
make m-c
```

# Сложности запуска
Для работы с superset нужно создать admin пользователя для того, чтобы зайти на сайт с клиентом:
```
docker exec -it <superset_container_name> superset fab create-admin \
    --username=admin --firstname=Admin --lastname=User \
    --email=admin@example.com --password=admin
```
Для создания volume для хранения данных clickhouse нужно сначала создать папку хранения, а затем 
присвоить ей права, с помощью которых к ней из контейнера будет доступ:
```
make clickhouse-data
sudo chown 101 clickhouse-data
```
