version: '3'

services:
  clickhouse:
    image: yandex/clickhouse-server:latest
    user: clickhouse
    environment:
      - CLICKHOUSE_DB=${BOOKCOURT_DB}
      - CLICKHOUSE_USER=${BOOKCOURT_USER}
      - CLICKHOUSE_PASSWORD=${BOOKCOURT_PASSWORD}
    ports:
      - "9000:9000"
      - "8123:8123"
    volumes:
      - ./clickhouse-data:/var/lib/clickhouse
    command: ["clickhouse-server", "--config-file=/etc/clickhouse-server/config.xml"]
  redis:
    image: redis:latest
    container_name: redis
    ports:
      - "6379:6379"
    networks:
      - my_network

  redis_insight:
    image: redislabs/redisinsight:latest
    container_name: redis_insight
    ports:
      - "8001:8001"
    networks:
      - my_network

  #superset:
  #  image: apache/superset:latest
  #  ports:
  #    - "8088:8088"
  #  environment:
  #    - SUPERSET_LOAD_EXAMPLES=yes
  #    - PYTHONPATH=/app/superset:$PYTHONPATH
  #    - SUPERSET__SQLALCHEMY_DATABASE_URI=clickhouse://default:@clickhouse:9000
  #  volumes:
  #    - ./superset_config.py:/app/superset/superset_config.py
  #  command: ["superset", "run", "-h", "0.0.0.0", "-p", "8088"]
volumes:
  clickhouse-data:

networks:
  my_network:
    driver: bridge


